<style>
/* Scrollbar Stuff */
.ssb_down{
  background:transparent url(icon-arrow-down.png);
  bottom:0;
  cursor:pointer;
  position:absolute;
  right:0;
}

.ssb_sb{
  background:transparent url(middle.png);
  cursor:pointer;
  position:absolute;
  right:0;
}

.ssb_sb_down{
  background:transparent url(middrag.png);
}

.ssb_sb_over{
  background:transparent url(midhover.png);
}

.ssb_st{
  background:transparent url(back.png);
  cursor:pointer;
  height:100%;
  position:absolute;
  right:0;
  top:0;
}

.ssb_up{
  background:transparent url(icon-arrow-up.png);
  cursor:pointer;
  position:absolute;
  right:0;
  top:0;
}

/* Document Stuff */
body{
  background:#eee;
  margin: 0px;
  padding: 0px;
}
.outer{
  display: flex;  /* Verical align    */
  height: 100%;   /* Verical align    */
  margin: 0 auto; /* Horizontal align */
  width: 80%;     /* Horizontal align */
}
.inner{
  position: relative;
  height: 50%;
  width: 100%;
  margin: auto 0px;
  background: #fff;
  border: 1px #000 solid;
  overflow: hidden;
}
#main_content{
  position: relative;
  width: 100%;
  margin: 0px;
  overflow: auto;
}
#main_content > div{
  /*margin: 0px;*/
}

html, body{
  overflow: hidden;
  height: 100%;
}

#main_content{
  overflow: auto;
  width: 100%;
  height: 100%;
}

.custom-scrollbar{
  position: absolute;
  top: 0px;
  height: 100%;
}
.custom-scrollbar > .track{
  position: relative;
  width: 100%;
  height: 100%;
}
.custom-scrollbar > .thumb{
  position: absolute;
  width: 100%;
  background-color: gold;
}
.custom-scrollbar > .up,
.custom-scrollbar > .down{
  position: relative;
  width: 100%;
  height: 16px; /* CHANGE THIS! IT IS VARIABLE OR USER-DEFINED! */
}
.custom-scrollbar > .up{
}
.custom-scrollbar > .down{
}
</style>

<!DOCTYPE html>
<html>
<head>
  <title>Testing</title>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
</head>
<body>
  <div class="outer">
    <div class="inner">
      <div id="main_content">
        <div>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Duis in pharetra odio. Aliquam nisi diam, ultrices at fringilla suscipit, malesuada aliquam enim. Suspendisse congue lacinia diam fermentum feugiat. Nunc dignissim ullamcorper tortor, ut porta justo interdum sed. Sed quam urna, laoreet ut magna vel, malesuada iaculis ex. Curabitur massa elit, consectetur at tincidunt ut, placerat eget leo. Vestibulum malesuada nec est sit amet sagittis. Sed ligula sapien, condimentum eu varius at, ornare vitae enim. Morbi convallis venenatis tristique.</div>
        <div>Duis egestas dolor turpis, et semper mi accumsan vel. Etiam fermentum eleifend ullamcorper. Praesent gravida purus ultricies, pretium nulla non, finibus metus. Integer ut aliquet ipsum. Etiam in ornare odio. Donec blandit urna at magna consectetur interdum. Maecenas non massa sem.</div>
        <div>Aliquam vel elementum ante. Nunc eget risus ipsum. Proin nec dignissim est. In sit amet sapien ante. Proin aliquam enim et ante lacinia eleifend. Praesent lobortis tristique nunc, sed tempus ante bibendum in. Donec ut semper tortor. Aliquam id elit ipsum. Morbi sit amet sagittis risus. Vivamus ultricies pellentesque justo, a lacinia magna auctor ut.</div>
        <div>Duis rhoncus ex nec ante condimentum fringilla. Aliquam felis augue, tristique et justo in, posuere porta sem. Fusce gravida euismod facilisis. Nunc feugiat condimentum orci eu lacinia. Cras non consectetur velit. Suspendisse lacinia gravida massa at dictum. In non velit quis nulla congue tempor. Integer lobortis suscipit lorem ac sollicitudin.</div>
        <div>Duis luctus nibh iaculis, porta erat ac, pulvinar mauris. Aenean vel nunc turpis. Nam a maximus quam, id faucibus erat. Etiam porttitor vulputate rutrum. Phasellus blandit semper augue non posuere. Cras egestas eros vitae laoreet gravida. Donec id tortor metus. Pellentesque turpis nulla, tempor vel blandit quis, sollicitudin vel ipsum. Fusce venenatis elit et sapien maximus fermentum. Proin a dui vitae felis vestibulum auctor at eget turpis. Phasellus vulputate semper volutpat. Vivamus vulputate sapien vel lacus sollicitudin, at pharetra arcu elementum. Donec eu luctus ex. Nunc eget dapibus orci.</div>
        <div>Donec tempor placerat posuere. Suspendisse potenti. Donec faucibus pellentesque ornare. Maecenas semper rhoncus rutrum. In tincidunt risus a auctor faucibus. Pellentesque placerat convallis dolor, quis accumsan nisl gravida sed. Vivamus vitae ligula justo. Suspendisse pulvinar diam eget tellus commodo varius. Proin a libero rhoncus, pharetra dui mattis, imperdiet lectus.</div>
        <div>Nam et ante a nunc gravida gravida. Sed congue tristique molestie. Donec ut leo ante. Nulla sollicitudin mauris sed tortor porttitor consequat. Vestibulum vitae felis quis nisi euismod tempus ut sed magna. Sed cursus massa quis aliquet faucibus. Aenean sed scelerisque purus. Curabitur lacus diam, malesuada ac magna dignissim, fringilla efficitur mauris. Integer fermentum erat ac massa dignissim volutpat. Cras ullamcorper consequat est nec suscipit. Maecenas finibus mollis dolor sed sodales. Integer commodo, lorem et vehicula convallis, nunc mi tristique nisl, ac suscipit libero tortor quis lectus. Maecenas quis convallis turpis. Pellentesque vitae magna ultrices, blandit odio ut, placerat lectus. Suspendisse fermentum porttitor turpis eu dignissim. Ut porttitor tristique arcu, non tristique lacus molestie dignissim.</div>
        <div>Proin consectetur, nulla eget pellentesque vestibulum, dui nisi tempor dolor, vel ultricies nulla ex vitae dolor. Etiam facilisis mi orci, eu facilisis lorem aliquet non. Duis pellentesque nibh sit amet varius laoreet. Vivamus viverra augue tellus, ornare mollis tellus mattis eu. Phasellus velit metus, feugiat ultricies ultrices sit amet, ullamcorper dapibus mi. In hac habitasse platea dictumst. Vivamus non porta nulla.</div>
        <div>Interdum et malesuada fames ac ante ipsum primis in faucibus. Nulla sit amet metus ut enim interdum ultricies. Ut vitae erat quis massa ultrices rhoncus. Quisque dapibus scelerisque neque, suscipit rhoncus dui sodales in. Sed tincidunt molestie sem nec consequat. Nam id purus sem. Nunc sagittis imperdiet ligula, et ultrices neque dictum eu. Mauris ultrices volutpat cursus. Vestibulum placerat nulla et tincidunt laoreet. Aliquam nisi erat, cursus ac faucibus quis, sollicitudin sed nisi.</div>
        <div>Sed ac nulla sit amet felis vestibulum sollicitudin id ullamcorper tellus. Nam semper odio felis, et pellentesque enim vulputate quis. Nulla fermentum lectus orci, quis ultrices lacus egestas rhoncus. Nullam vestibulum lobortis mi, vitae convallis orci pretium quis. Donec eget enim vel leo cursus mattis molestie sollicitudin dolor. Duis placerat erat vel felis maximus, quis pharetra augue varius. Donec bibendum malesuada eros sit amet facilisis. Phasellus condimentum, ipsum nec finibus viverra, diam enim gravida nisi, in dapibus turpis mi eget nisi. Maecenas a massa ligula.</div>
        <div>Duis rhoncus ex nec ante condimentum fringilla. Aliquam felis augue, tristique et justo in, posuere porta sem. Fusce gravida euismod facilisis. Nunc feugiat condimentum orci eu lacinia. Cras non consectetur velit. Suspendisse lacinia gravida massa at dictum. In non velit quis nulla congue tempor. Integer lobortis suscipit lorem ac sollicitudin.</div>
        <div>Duis luctus nibh iaculis, porta erat ac, pulvinar mauris. Aenean vel nunc turpis. Nam a maximus quam, id faucibus erat. Etiam porttitor vulputate rutrum. Phasellus blandit semper augue non posuere. Cras egestas eros vitae laoreet gravida. Donec id tortor metus. Pellentesque turpis nulla, tempor vel blandit quis, sollicitudin vel ipsum. Fusce venenatis elit et sapien maximus fermentum. Proin a dui vitae felis vestibulum auctor at eget turpis. Phasellus vulputate semper volutpat. Vivamus vulputate sapien vel lacus sollicitudin, at pharetra arcu elementum. Donec eu luctus ex. Nunc eget dapibus orci.</div>
        <div>Donec tempor placerat posuere. Suspendisse potenti. Donec faucibus pellentesque ornare. Maecenas semper rhoncus rutrum. In tincidunt risus a auctor faucibus. Pellentesque placerat convallis dolor, quis accumsan nisl gravida sed. Vivamus vitae ligula justo. Suspendisse pulvinar diam eget tellus commodo varius. Proin a libero rhoncus, pharetra dui mattis, imperdiet lectus.</div>
        <div>Nam et ante a nunc gravida gravida. Sed congue tristique molestie. Donec ut leo ante. Nulla sollicitudin mauris sed tortor porttitor consequat. Vestibulum vitae felis quis nisi euismod tempus ut sed magna. Sed cursus massa quis aliquet faucibus. Aenean sed scelerisque purus. Curabitur lacus diam, malesuada ac magna dignissim, fringilla efficitur mauris. Integer fermentum erat ac massa dignissim volutpat. Cras ullamcorper consequat est nec suscipit. Maecenas finibus mollis dolor sed sodales. Integer commodo, lorem et vehicula convallis, nunc mi tristique nisl, ac suscipit libero tortor quis lectus. Maecenas quis convallis turpis. Pellentesque vitae magna ultrices, blandit odio ut, placerat lectus. Suspendisse fermentum porttitor turpis eu dignissim. Ut porttitor tristique arcu, non tristique lacus molestie dignissim.</div>
      </div>
    </div>
  </div>
</body>
</html>

<script>

$.fn.csb = function(){
  var mainContent = $(this)[0];
  var step  = 10;
  var delay = 100;
  var newScrollPosition;

  function Scroll(){
    var cs    = $(this).parent().find(".custom-scrollbar");
    var track = $(cs).find(".track");
    var thumb = $(cs).find(".thumb");
    var up    = $(cs).find(".up");
    var down  = $(cs).find(".down");

    // offsetHeight: Stays the same = Height of the scrollable element               [335]
    // scrollHeight: Stays the same = Total height of all content within the element [882]
    // scrollTop:    Goes from 0 to (offsetHeight - scrollHeight)                    [0-547]

    // console.log(`offsetHeight = ${this.offsetHeight} | scrollHeight = ${this.scrollHeight} | scrollTop = ${this.scrollTop}`);
    // console.log(`Scroll Percentage = ${this.scrollTop / (this.scrollHeight-this.offsetHeight) * 100}%`);

    // Set padding-right to the width of the default scrollbar
    var scrollbarWidth = this.offsetWidth - this.clientWidth + "px";
    $(this).css("padding-right", scrollbarWidth);

    // These can be user-defined, but 16x16 is the defaults
    var buttonWidth = 16;
    var buttonHeight = 16;

    // Calculate the thumb height
    var thumbWidth = 16;
    var thumbHeight = 64;
    $(thumb).css("width", thumbWidth + "px");
    $(thumb).css("height", thumbHeight + "px");

    var yoloSwag = this.offsetHeight - (buttonHeight * 2);
    $(track).css("height", yoloSwag + "px");
    // $(track).css("top", 16 + "px");

    // Up and Down arrow buttons are both 16x16
    // Thumb height is 16px high
    // Therefore, decrease the track sliding length by 48 = 16*2 + 64
    var offsetHeight2 = this.offsetHeight - 96;

    // var scrollPercentage = this.scrollTop / (this.scrollHeight - this.offsetHeight) * this.offsetHeight;
    var delta = this.scrollTop / (this.scrollHeight - this.offsetHeight);
    var scrollPercentage = delta * offsetHeight2 + 16; // 16 = Height of one button

    $(thumb).css("top", scrollPercentage);

    $(cs).css("width", "16px");               // USER-DEFINED!
    $(track).css("background-color", "gray"); // USER-DEFINED!

    if(delta == 0) $(up).css("background-color", "cyan");
    else           $(up).css("background-color", "blue");

    if(delta == 1) $(down).css("background-color", "lightgreen");
    else           $(down).css("background-color", "green");
  }

  function ScrollWithButton(){
    var newScrollPosition;

    if($(ScrollWithButton.self).hasClass("up")){
      newScrollPosition = (mainContent.scrollTop - step);
      console.log(newScrollPosition);
      if(newScrollPosition < 0)
        newScrollPosition = 0;
    }else{
      newScrollPosition = (mainContent.scrollTop + step);
      if(newScrollPosition > mainContent.scrollHeight - mainContent.offsetHeight)
        newScrollPosition = mainContent.scrollHeight - mainContent.offsetHeight;
    }

    $(mainContent).stop().animate({
      scrollTop: newScrollPosition
    }, delay);
  }

  function ButtonClick(event){
    event.preventDefault();
    ScrollWithButton.self = this;
    ScrollWithButton();
    var timeout = setInterval(ScrollWithButton, delay);
    $(document).mouseup(function(){clearInterval(timeout);});
  }

  function ClickOnTrack(event){
    event.preventDefault();
    var offsetY = $(this).offset().top;
    var clickHeight = event.pageY - offsetY;
    var trackHeight = parseFloat($(track).css("height"));
    var thumbHeight = parseFloat($(thumb).css("height"));
    var upperMargin = thumbHeight/2;
    var lowerMargin = trackHeight - thumbHeight/2;
    var trackHeightNoMargin = lowerMargin - upperMargin;
    var trackMultiplier = 100 / trackHeightNoMargin;
    var delta = mainContent.scrollHeight - mainContent.offsetHeight;
    var percent;

    // If the user clicked in the upper or lower margin of the scrollbar,
    // it would act like the user clicked on the boundary of the margin instead
    if(clickHeight < upperMargin)       clickHeight = upperMargin;
    else if(clickHeight > lowerMargin) clickHeight = lowerMargin;

    // Remove the margin so that we can calculate the percentage
    clickHeight -= upperMargin;

    // Finally, find the percentage and set it
    percent = ((clickHeight * trackMultiplier) / 100) * delta;

    $(mainContent).stop().animate({
      scrollTop: percent
    }, delay);
  }

  var qwe = this.parent().append(`
  <div class="custom-scrollbar">
    <div class="up"></div>
    <div class="track"></div>
    <div class="down"></div>
    <div class="thumb"></div>
  </div>
  `);

  qwe.prepend(this);
  $(this).scroll(Scroll);
  var up    = $(this).parent().find(".up");
  var down  = $(this).parent().find(".down");
  var track = $(this).parent().find(".track");
  var thumb = $(this).parent().find(".thumb");
  $(up).mousedown(ButtonClick);
  $(down).mousedown(ButtonClick);
  $(track).mousedown(ClickOnTrack);
  $(this).trigger("scroll");
}

window.onload = function(){
  // Initialize the custom scrollbar
  $("#main_content").csb();
  // ssb.scrollbar("#main_content");
}

var ssb = {
  aConts  : [],
  mouseY : 0,
  N  : 0,
  asd : 0, /*active scrollbar element*/
  sc : 0,
  sp : 0,
  to : 0,

  // constructor
  // function scrollbar(cont_id){
  scrollbar : function(cont_id) {
    var cont = $(`${cont_id}`)[0];

    // perform initialization
    if(!ssb.init())
      return false;

    var cont_clone = cont.cloneNode(false);
    cont_clone.style.overflow = "hidden";
    cont.parentNode.appendChild(cont_clone);
    cont_clone.appendChild(cont);
    cont.style.position = 'absolute';
    cont.style.left = cont.style.top = '0px';
    cont.style.width = cont.style.height = '100%';

    // adding new container into array
    ssb.aConts[ssb.N++] = cont;
    cont.sg = false;

    // creating scrollbar child elements
    cont.st = this.create_div('ssb_st', cont, cont_clone);
    cont.sb = this.create_div('ssb_sb', cont, cont_clone);
    cont.su = this.create_div('ssb_up', cont, cont_clone);
    cont.sd = this.create_div('ssb_down', cont, cont_clone);

    // on mouse down processing
    cont.sb.onmousedown = function (e){
      if (!this.cont.sg){
        if (! e) e = window.event;
        ssb.asd = this.cont;
        this.cont.yZ = e.screenY;
        this.cont.sZ = cont.scrollTop;
        this.cont.sg = true;
        // new class name
        this.className = 'ssb_sb ssb_sb_down';
      }
      return false;
    }

    // on mouse down on free track area - move our scroll element too
    cont.st.onmousedown = function (e){
      if (! e) e = window.event;
      ssb.asd = this.cont;
      ssb.mouseY = e.clientY + document.body.scrollTop + document.documentElement.scrollTop;
      for (var o = this.cont, y = 0; o != null; o = o.offsetParent) y += o.offsetTop;
      this.cont.scrollTop = (ssb.mouseY - y - (this.cont.ratio * this.cont.offsetHeight / 2) - this.cont.sw) / this.cont.ratio;
      this.cont.sb.onmousedown(e);
    }

    // onmousedown events
    cont.su.onmousedown = cont.su.ondblclick = function (e) { ssb.mousedown(this, -1); return false; }
    cont.sd.onmousedown = cont.sd.ondblclick = function (e) { ssb.mousedown(this,  1); return false; }
    //onmouseout events
    cont.su.onmouseout = cont.su.onmouseup = ssb.clear;
    cont.sd.onmouseout = cont.sd.onmouseup = ssb.clear;
    // on mouse over - apply custom class name: ssb_sb_over
    cont.sb.onmouseover = function (e){
      if (! this.cont.sg) this.className = 'ssb_sb ssb_sb_over';
      return false;
    }

    // on mouse out - revert back our usual class name 'ssb_sb'
    cont.sb.onmouseout  = function (e){
      if (! this.cont.sg) this.className = 'ssb_sb';
      return false;
    }

    // onscroll - change positions of scroll element
    cont.ssb_onscroll = function (){
      this.ratio = (this.offsetHeight - 2 * this.sw) / this.scrollHeight;
      this.sb.style.top = Math.floor(this.sw + this.scrollTop * this.ratio) + 'px';
    }

    // scrollbar width
    cont.sw = 20;
    // start scrolling
    cont.ssb_onscroll();
    ssb.refresh();
    // binding own onscroll event
    cont.onscroll = cont.ssb_onscroll;
    return cont;
  },

  // initialization
  init : function (){
    if (window.oper || (! window.addEventListener && ! window.attachEvent))
      return false;

    // temp inner function for event registration
    function addEvent (o, e, f){
      if(window.addEventListener){
        o.addEventListener(e, f, false);
        ssb.w3c = true;
        return true;
      }

      if(window.attachEvent)
        return o.attachEvent('on' + e, f);

      return false;
    }

    // binding events
    addEvent(window.document, 'mousemove', ssb.onmousemove);
    addEvent(window.document, 'mouseup', ssb.onmouseup);
    addEvent(window, 'resize', ssb.refresh);
    return true;
  },

  // create and append div func
  create_div : function(c, cont, cont_clone) {
    var o = document.createElement('div');
    o.cont = cont;
    o.className = c;
    cont_clone.appendChild(o);
    return o;
  },

  // do clear of controls
  clear : function () {
    clearTimeout(ssb.to);
    ssb.sc = 0;
    return false;
  },

  // refresh scrollbar
  refresh : function () {
    for (var i = 0, N = ssb.N; i < N; i++) {
    var o = ssb.aConts[i];
    o.ssb_onscroll();
    o.sb.style.width = o.st.style.width = o.su.style.width = o.su.style.height = o.sd.style.width = o.sd.style.height = o.sw + 'px';
    o.sb.style.height = Math.ceil(Math.max(o.sw * .5, o.ratio * o.offsetHeight) + 1) + 'px';
    }
  },

  // arrow scrolling
  arrow_scroll : function () {
    if (ssb.sc != 0) {
    ssb.asd.scrollTop += 6 * ssb.sc / ssb.asd.ratio;
    ssb.to = setTimeout(ssb.arrow_scroll, ssb.sp);
    ssb.sp = 32;
    }
  },

  /* event binded functions : */
  // scroll on mouse down
  mousedown : function (o, s) {
    if (ssb.sc == 0) {
      // new class name
      o.cont.sb.className = 'ssb_sb ssb_sb_down';
      ssb.asd = o.cont;
      ssb.sc = s;
      ssb.sp = 400;
      ssb.arrow_scroll();
    }
  },

    // on mouseMove binded event
  onmousemove : function(e) {
    if (! e) e = window.event;
    // get vertical mouse position
    ssb.mouseY = e.screenY;
    if (ssb.asd.sg) ssb.asd.scrollTop = ssb.asd.sZ + (ssb.mouseY - ssb.asd.yZ) / ssb.asd.ratio;
  },

  // on mouseUp binded event
  onmouseup : function (e) {
    if (! e) e = window.event;
    var tg = (e.target) ? e.target : e.srcElement;
    if (ssb.asd && document.releaseCapture) ssb.asd.releaseCapture();
    // new class name
    if (ssb.asd) ssb.asd.sb.className = (tg.className.indexOf('scrollbar') > 0) ? 'ssb_sb ssb_sb_over' : 'ssb_sb';
    document.onselectstart = '';
    ssb.clear();
    ssb.asd.sg = false;
  }
}
</script>
